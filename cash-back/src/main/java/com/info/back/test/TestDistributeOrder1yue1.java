package com.info.back.test;

import com.info.back.dao.IBackUserDao;
import com.info.back.service.*;
import com.info.back.utils.BackConstant;
import com.info.web.pojo.*;
import org.junit.runner.RunWith;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.test.context.ContextConfiguration;
import org.springframework.test.context.junit4.SpringJUnit4ClassRunner;

import java.math.BigDecimal;
import java.util.Date;

/**
 * 类描述：
 * 创建人：yyf
 * 创建时间：2018/12/29 0029下午 05:01
 */
@RunWith(SpringJUnit4ClassRunner.class)
@ContextConfiguration(locations = {"file:src/main/resources/applicationContext.xml"})
public class TestDistributeOrder1yue1 {
    @Autowired
    IBackUserDao backUserDao;

    @Autowired
    private IMmanLoanCollectionOrderService mmanLoanCollectionOrderService;
    @Autowired
    private IMmanLoanCollectionStatusChangeLogService mmanLoanCollectionStatusChangeLogService;
    @Autowired
    private IMmanLoanCollectionCompanyService collectionCompanyService;
    @Autowired
    private IMmanUserLoanService mmanUserLoanService;
    @Autowired
    private ICreditLoanPayService creditLoanPayService;


    @org.junit.Test
    public void doDistributeOrder() {
//
        String userNames = "宋鹏,胡骁,李文珏,高泽同,高强,王磊,付甜甜,李纬文,高艺,耿佩东,郭宝丽,靳浩南,李琛宇,栗婷,栗亚玲,栗亚娜,连星宇,刘懂,刘玉立,栾喜凤,马新月,马洋,宁卉康,牛璐梅,秦帅,宋佳欣,宋柯,苏琳均,王升,张婷,葛文玲,赵欢,王晶晶1,徐娟娟,朱青凤,李想,朱少祥,宋国纹,韩国峰,金双,王子帅,高沙红,乔明光,周苏宁,蔡敬升,刘静,崔蔷薇,刘韩强,陈梦翔,强珊珊,卢宁,章浩锐,冯瑞思,郝雅璇,李浩然,梁凯,冀刚,贺晓倩,高扬扬,郭宏伟,张骑山,於美佳,胡佳辉,高露,武海,倪尚聪,任晓涵,郭怡彤,孙民政,宋艳1,单佳乐,苏毅,张锦,徐文静,张玲玲,郭星宇,郭晓健,池剑,李飞,李宗文,郭冰雁,张磊1,白建朝,韩奋斌,钟小华,郭一,张二,白三,韩四,钟五";
        String loadIds = "51992516,52001123,51976520,51998308,51980558,51983924,51988951,52004723,52012694,52011223,52021799,51984820,51991831,51996217,51994638,51975050,51985032,51994415,51972581,51981461,52004245,52016043,51981227,51972346,51977194,52012881,52030953,51989250,52013353,52009220,52001490,51984733,51990271,52014891,51981007,52013193,51985432,51995378,52014699,52023309,52010682,52052449,51997624,51982273,52022158,52020145,51990459,51997027,51995367,51994458,52001121,52022983,52002571,52000752,52016062,52015373,51984520,51991955,51925853,51956518,51946233,51912706,52012796,51929479,51939374,51956834,51961210,51964782,51957559,51938469,51935643,51943473,51941199,51928801,51914744,51970921,51921875,51950578,51949414,51954363,51955235,51916111,51952926,51922580,51916465,52009767,51940043,51925857,51921359,51931585,51933121,51955232,51922389,51916806,51930518,51924767,52009204,52004453,51955627,51949576,51941393,51963214,51926982,51921223,51935366,51921404,51946136,51935180,51947967,51915574,51970600,51918412,52023293,51929110,51967586,51919427,51925766,51916633,51935228,51926185,51996506,51945651,51921118,51949878,51926405,51952348,51951370,51930998,51912268,51994157,51919370,51919816,51914000,51932703,51958763,51951127,51930299,51927432,51958734,51922717,51948331,51941358,51936887,51962601,51957910,51932452,51930313,51915123,51932898,51948630,51942696,51966247,51955376,52022867,51945570,51918028,51969761,51937501,51940187,51995638,51941672,51913622,51919200,52018935,51938217,51930006,51934745,51960423,51916492,51970655,51925452,51989319,51919265,51984783,51920690,51933049,51970984,51921497,51964391,51970725,51926530,51927297,51933059,51934534,51954707,51933029,51966815,51944274,51963595,51960146,51933874,51965538,51953210,51949262,51925605,51998898,51955624,51986192,51967160,51928556,51916247,51950933,51919906,51934264,51926067,51942548,51935509,51946893,51927956,51944108,51968825,51933884,51914940,51925570,51923968,51963722,51919256,51955410,52019974,51917017,51914562,51959105,51920249,52011254,51964237,51945467,51985600,51988149,51962622,51961339,51953057,51920966,51997068,51943128,51953800,51958281,51960481,51932149,51935351,51970714,51939819,51931719,51912874,51965519,51915491,51928268,52008221,51927449,51975098,51961459,51937667,51915198,51960690,51929950,51936047,51916044,51949010,51980223,51918722,51938630,51923804,51912644,51912741,51950249,51963231,51961710,51961911,51919604,51935335,51970300,51971330,51942747,51940102,51969238,52014254,51930378,51959511,51915562,51961817,52017843,51933172,51958822,51987587,51963070,51922547,51925752,51946172,51958323,52002548,51951300,51959533,51958021,51964196,51996710,51948037,51918195,51945430,51936402,51913398,51941264,51970982,51922593,51942797,51951276,51924933,51930087,51969770,51920388,51917955,51938673,51949113,51931671,51913529,52023399,51951701,51978601,51918043,51940779,51945114,51939432,51927123,51968457,51955027,51920197,51935315,51959003,51971543,51917341,51942016,51922311,51934010,51922445,51912529,51917318,51922218,51955374,51949747,51954264,51953965,51919721,51998313,51959380,51986888,51964241,51929044,51929941,51923712,51957567,51965836,51957814,51954828,51969985,52013439,51945477,51940175,51951885,51913540,51971227,51971402,51920125,51959939,51966442,51965546,51953021,51968004,51966990,51920666,51937005,51939156,51927225,51911293,51996701,51929884,52013296,51917783,51930117,51957039,51915213,51953568,51923829,51931923,51920432,51912981,51925609,51986222,51938701,51948270,51949157,51947320,51979575,51955238,51920491,51961179,51972405,51931192,51944580,51941343,51934297,51917117,51928627,51918267,51954246,51939539,51949853,51932971,51966222,51964377,51968163,51944892,51937318,51943024,51992871,51991995,51920428,51957395,51936833,51967583,51965974,51926357,51933187,51919143,51969502,51917147,51914127,51947657,51924927,51927726,51961663,51975627,51945411,51927316,51962092,51968402,51943911,51930827,51962525,51947834,51955093,51958318,51930868,51949696,51916055,51939123,51921889,51922921,51915858,51937937,51916507,51969933,51943194,51920370,51924475,51988410,51961211,51928368,51922493,51944332,51956477,51939677,51941494,51950048,51929107,51919359,51951523,51916865,51923964,51969504,51944672,51928590,51937881,51947668,51966415,51917232,51962813,51969334,51968194,51937269,51921847,51962636,51915549,51947660,51954349,51976210,51924714,51929563,51924837,51951750,51961588,51916140,51934475,51946371,51925189,51917971,51940294,51935333,51914120,51920518,51959951,51915181,52023610,51953313,51949018,51934872,51969691,51928644,51953322,51916228,51960161,51937331,51936207,51948036,51935380,51922206,51962874,51926184,51919563,51922019,51927754,51941986,51925237,51928094,51924033,51962318,51948117,51947165,51946554,51961160,51925512,51924198,51947902,51966520,51978500,51959633,51921276,51942095,51914973,51926340,51923924,51924670,51956015,51933055,51933412,51954403,51963505,51961278,51917145,51914292,51926899,51926584,51915151,51985553,51967162,52008743,51960863,51919862,51914739,51929642,51994899,51926328,51931382,51966320,51932774,51980392,51945780,51943748,51968669,51968562,51951899,51922865,51947132,51967545,51953016,51928353,51938506,51930796,51947066,51924583,51929441,51958601,51916550,51980490,51936203,51945634,51968148,51925638,51960002,51934115,51941364,51939824,51920938,51966765,51919955,51943164,51948328,51962662,51957962,51919969,51950846,51943841,51943534,51966304,51939060,51966280,51924467,51954087,51952673,51920009,51926437,51938922,51918434,51966998,51927300,51922878,51959455,51942545,51955768,51916361,51967360,51920394,51922061,51963382,51953896,51952239,51941500,51918555,51950204,51952406,51955182,51933960,51938183,51947978,51912659,51916386,51977337,51951471,51954476,51970275,51955568,51915350,51962593,51927687,51981471,51935174,51941486,51926253,51945020,51982318,51912646,51919074,51954053,51919316,51942938,51922354,52017592,51951963,51958680,51921815,51913933,51963221,51970323,51938214,51917457,51916430,51962811,51923154,51927669,51931267,51943051,51924937,51967010,51924960,51943158,51964799,52000461,51918232,51937532,51960568,51952649,51926172,51966927,51935634,51929561,51917055,51938878,51956837,51954448,51941797,51939696,51946115,51919020,51994460,51922935,51925424,51933626,51920499,51934643,51960395,51954105,51960601,51949367,51967059,51921467,51941252,51911155,51888795,51900776,51939986,51861850,51907825,51935043,51946035,51863687,51892778,51881941,51904190,51889796,51888847,51910856,51869838,51885629,51865333,51885830,51906571,51871883,51894806,51882858,51893914,51900220,51886222,51919275,51894265,51901489,51857945,51859328,51902834,51901706,51968852,51901833,51861933,51880126,51904107,51875291,51909882,51860172,51904028,51873258,51894583,51945145,51894187,51910003,51866775,51873009,51873420,51902197,51910927,51868302,51857764,51872582,51881377,51946055,51880849,51862909,51865855,51900471,51863579,51882806,51867509,51898381,51877496,51905137,51890459,51863300,51895725,51901555,51960663,51927516,51865472,51885192,51893714,51877184,51934424,51934240,51901742,51862274,51871894,51917201,51863534,51925131,51897330,51867879,51878994,51889547,51905796,51865767,51906525,51894351,51878150,51875847,51862204,51858474,51865181,51873456,51908751,51892814,51894051,51873214,51900571,51874901,51866374,51872196,51861062,51900810,51867033,51892729,51896942,51882911,51905358,51889844,51893145,51868968,51899101,51894259,51903002,51886493,51860220,51858548,51893546,51893470,51876158,51906199,51888906,51871284,51848804,51930440,51913913,51862920,51886987,51889598,51876901,51911140,51899100,51893939,51939326,51890447,51932799,51903421,51872062,51907679,51883195,51846823,51907325,51877044,51863470,51880687,51888485,51942494,51928232,51878458,51880361,51878177,51892266,51897142,51943875,51886527,51867529,51902977,51885511,51899060,51862931,51890675,51967330,51869617,51906531,51898463,51968112,51894433,51878423,51899152,51876013,51878117,51862515,51878985,51939450,51892269,51876243,51862716,51898043,51897970,51911720,51896510,51863981,51912074,51900679,51863905,51939164,51869867,51935256,51870748,51865641,51859407,51868695,51878434,51875016,51957308,51846529,51870317,51859294,51864319,51860616,51881348,51895329,51865071,51899210,51903220,51874987,51886613,51892449,51875644,51868924,51904467,51868219,51891767,51865751,51858426,51870769,51873187,51905706,51872923,51870208,51859584,51909447,51890626,51865549,51893619,51901008,51879583,51873482,51859031,51890208,51871546,51883850,51889788,51899573,51884951,51878759,51867541,51857770,51862311,51881853,51878773,51858804,51924733,51872230,51882505,51868288,51863359,51873199,51890986,51883788,51909284,51889110,51897460,51900246,51865596,51891187,51877443,51908180,51908925,51938820,51889797,51886717,51906725,51907903,51858964,51862555,51864252,51908088,51963838,51942923,51883274,51913532,51909064,51940585,51861486,51867232,51893327,51842839,51907361,51894455,51864542,51905280,51895783,51895792,51889288,51907805,51911975,51961867,51911841,51890670,51905048,51897262,51890183,51875712,51895532,51881383,51954222,51878153,51961040,51859766,51871010,51857866,51894423,51884718,51906115,51908299,51886316,51886554,51859325,51881836,51901512,51921349,51866035,51868511,51885642,51920591,51816998,51892851,51900311,51887581,51887990,51886789,51892963,51857795,51895267,51872949,51949764,51893095,51905791,51871904,51892305,51897028,51863307,51927507,51912599,51884738,51884039,51873137,51883462,51864672,51890279,51870959,51895171,51867306,51882804,51916494,51866575,51890166,51907746,51932962,51859460,51887775,51911420,51866499,51951582,51902177,51902912,51871093,51902073,51909703,51909002,51883251,51868178,51863507,51889898,51897646,51899876,51899256,51868482,51901869,51869062,51876084,51903286,51956269,51876006,51907817,51908771,51910492,51903503,51940450,51872469,51928436,51905040,51862437,51904182,51893677,51912149,51890545,51867535,51872767,51862393,51890490,51857736,51874159,51875420,51909617,51908268,51908306,51903167,51866255,51866890,51899317,51912159,51858444,51894082,51895237,51884647,51925583,51874798,51872498,51888641,51868096,51871241,51880873,51866970,51872511,51877542,51864049,51871083,51876969,51862997,51905801,51864567,51884461,51863550,51970150,51865689,51898641,51882079,51901758,51862001,51890650,51889384,51861761,51906956,51878371,51858777,51872962,51873861,51890837,51857810,51887121,51903809,51866995,51909200,51859939,51892673,51901365,51869998,51850709,51898253,51899601,51880116,51913199,51870263,51869625,51860255,51869126,51857895,51948365,51912109,51906164,51910699,51956069,51890426,51873576,51858580,51886434,51902135,51867811,51860015,51871176,51863585,51869247,51879204,51864898,51883174,51861253,51881140,51909801,51862048,51888453,51862825,51886796,51894177,51957345,51867458,51894333,51872507,51952958,51868842,51889177,51872414,51904550,51880681,51858200,51882062,51881619,51917223,51869215,51965477,51857878,51861471,51863427,51913189,51910120,51883813,51908624,51861169,51908470,51869026,51946200,51934696,51884688,51889481,51872954,51864249,51909815,51894853,51878638,51897249,51890584,51920556,51876485,51877722,51902716,51867896,51924087,51873586,51901749,51917167,51902680,51869647,51863214,51859494,51892222,51882122,51873376,51959672,51893300,51946831,51886011,51881145,51863042,51864131,51889725,51870744,51928783,51944186,51865259,51884420,51903163,51881037,51858246,51886507,51934793,51894582,51943480,51885983,51878709,51869264,51867377,51870448,51882424,51870786,51872695,51899033,51880777,51865537,51907518,51913738,51851609,51789258,51828763,51868321,51807138,51831430,51845924,51821804,51846094,51846562,51805333,51822047,51814260,51834499,51839068,51834256,51828474,51834641,51853622,51815941,51815611,51797481,51862139,51830722,51833069,51830035,51824250,51813630,51820027,51852791,51856132,51850138,51806842,51821863,51853755,51815272,51816868,51803167,51819118,51899617,51839580,51854322,51845366,51834582,51803419,51809003,51818075,51825954,51814438,51803156,51852507,51891544,51811622,51819527,51836765,51832726,51829198,51880551,51803208,51866288,51817885,51831290,51854954,51818294,51832058,51804772,51816376,51827794,51842061,51812832,51820317,51816233,51833284,51807635,51820720,51839464,51834970,51833088,51849434,51903061,51851075,51856220,51826202,51819114,51837265,51835047,51847701,51828943,51831397,51835090,51801354,51835724,51826883,51804806,51852353,51820443,51829423,51886737,51818174,51840592,51816404,51808498,51832595,51840107,51823520,51830824,51902253,51819692,51821822,51862600,51845212,51825862,51819332,51803033,51816426,51843478,51842944,51819186,51812357,51832499,51895202,51826950,51823621,51829312,51830896,51839305,51824773,51826219,51870494,51826298,51826635,51811365,51810438,51842209,51810516,51817399,51831725,51819955,51813834,51825369,51835364,51827896,51853245,51821586,51844704,51857486,51834777,51824941,51871099,51826399,51834005,51848926,51844293,51847249,51818141,51803015,51810967,51850523,51805548,51825218,51907617,51829867,51832746,51853366,51832115,51813388,51808262,51836316,51826626,51844234,51835484,51826924,51816126,51857241,51832166,51808747,51854552,51828921,51813014,51850896,51827830,51810242,51804098,51903030,51848253,51833395,51790726,51827335,51830348,51834016,51844780,51837880,51813157,51885162,51805647,51842014,51804290,51812387,51828795,51802964,51836525,51829757,51809674,51846273,51810417,51844922,51845998,51836279,51828864,51815210,51827204,51818814,51816163,51819638,51833567,51817761,51825890,51813876,51833219,51841746,51837911,51821958,51808086,51810531,51807627,51855618,51809978,51833992,51853097,51847727,51808042,51816478,51850607,51816260,51851294,51817557,51847367,51845838,51822894,51808797,51854400,51808521,51898164,51805051,51807367,51897817,51841325,51815939,51853526,51805761,51853030,51813352,51842191,51833397,51868436,51827309,51848981,51844172,51818933,51803961,51824762,51833184,51830519,51853309,51836848,51833674,51839603,51844964,51812857,51850642,51864677,51839512,51838194,51833161,51804715,51834473,51827310,51837949,51852857,51845484,51810006,51868289,51812446,51803154,51842448,51813726,51808101,51816579,51824910,51815638,51842183,51807294,51833874,51821055,51818509,51807150,51838608,51853676,51834424,51807185,51825671,51838553,51854054,51827816,51824526,51834682,51848685,51842344,51827751,51855121,51802826,51846836,51824040,51840032,51813276,51842754,51864145,51844902,51854189,51840317,51855866,51817822,51824441,51853079,51839599,51849922,51826650,51810052,51816835,51835493,51816439,51833686,51820867,51847327,51817270,51848658,51818340,51810622,51834958,51847191,51806347,51848354,51869810,51828771,51809971,51828004,51820543,51816150,51817287,51829255,51824609,51834518,51824529,51819145,51841508,51900128,51830068,51854147,51848674,51841561,51812843,51872607,51810548,51844859,51874255,51844847,51854335,51888384,51822676,51856160,51818231,51864094,51850443,51827966,51825413,51813508,51839392,51837415,51831150,51834081,51826032,51813403,51836782,51854497,51805918,51909431,51844353,51803571,51815024,51825534,51851630,51831407,51845321,51821779,51836353,51826886,51841324,51839762,51816324,51839964,51838486,51830403,51834157,51867528,51840723,51817491,51873282,51821019,51809848,51826092,51839310,51804958,51831926,51811425,51821569,51832968,51806452,51817060,51840320,51819179,51834915,51850757,51821450,51835727,51834835,51832602,51823321,51893418,51830053,51805155,51854523,51847762,51876790,51844379,51809613,51845862,51819634,51844663,51840522,51859660,51856706,51808694,51849171,51847069,51805376,51851745,51812719,51851961,51839940,51850085,51816953,51902049,51827722,51848643,51841357,51827655,51820060,51813142,51846546,51839459,51813069,51830755,51807697,51891335,51809606,51808089,51833538,51848323,51911629,51858615,51819308,51811666,51828547,51845737,51893286,51838192,51842605,51832653,51810030,51879047,51802044,51830961,51806256,51839394,51844488,51815861,51832451,51818901,51808581,51841058,51795994,51862216,51827776,51849288,51812503,51855033,51822487,51848665,51851912,51844775,51822525,51826017,51828773,51854705,51868192,51807406,51846437,51813315,51818603,51807454,51825946,51813059,51821291,51859146,51846067,51805044,51815987,51807470,51857481,51823709,51843072,51827424,51814768,51824150,51855727,51815759,51816970,51812882,51855470,51838978,51835614,51827066,51832855,51802809,51852467,51875487,51824645,51827892,51806602,51826410,51851477,51848303,51855932,51848942,51808919,51809880,51815177,51817623,51828732,51823595,51835393,51854780,51854026,51846852,51813056,51863352,51856193,51818040,51840837,51839499,51894854,51912176,51846194,51804867,51818747,51803977,51806309,51775018,51798340,51794288,51760368,51780160,51798536,51757701,51786953,51788172,51737783,51802142,51776256,51767478,51785438,51779511,51752616,51791648,51771233,51758147,51756687,51779096,51779842,51776432,51757422,51780839,51765462,51752664,51788438,51770505,51771487,51767137,51786728,51760389,51777553,51767443,51787638,51756594,51799015,51751591,51797471,51784544,51765281,51774916,51751914,51785140,51797272,51787871,51762740,51755053,51760423,51775465,51784498,51752072,51797220,51790824,51754553,51781800,51781735,51773979,51771212,51756226,51788508,51791914,51775346,51764655,51797149,51772692,51773800,51773853,51762441,51757131,51787747,51752512,51774247,51753334,51754189,51776129,51798328,51788502,51794195,51787307,51770798,51795758,51784476,51762892,51784802,51785538,51773382,51761264,51763494,51751465,51783525,51696289,51753184,51780570,51790697,51782625,51801163,51752416,51798613,51799472,51755530,51777596,51759546,51787486,51788736,51782347,51766003,51768999,51772316,51798725,51802724,51800195,51772971,51757455,51757781,51754769,51780987,51787892,51793068,51800636,51779618,51797506,51783487,51788577,51759846,51773780,51751655,51755878,51792145,51767002,51752829,51775116,51787392,51801876,51777341,51753120,51774412,51797647,51768525,51795097,51754214,51755309,51781501,51769193,51756800,51785783,51734043,51768892,51801212,51775984,51791933,51767987,51777867,51761564,51759050,51752923,51774470,51764580,51774124,51792672,51791225,51763976,51757024,51794626,51754302,51777175,51772673,51771784,51791346,51789512,51800496,51777223,51791215,51777446,51768202,51800348,51779531,51752947,51755755,51796162,51791559,51792703,51794933,51752871,51765819,51792675,51756816,51798559,51795182,51759680,51783257,51760278,51780713,51764099,51776118,51766114,51763059,51754384,51756370,51799960,51767618,51780475,51797879,51754508,51753058,51780008,51793187,51771021,51777048,51779213,51794410,51763517,51789002,51761837,51773516,51781523,51766252,51785867,51783722,51782665,51785396,51751662,51760404,51778422,51767101,51784998,51756716,51775446,51769524,51775426,51780627,51753587,51788120,51764563,51786223,51782923,51780563,51792383,51783131,51756489,51780303,51760310,51772682,51763908,51768814,51780644,51787095,51761312,51767170,51796028,51778044,51778477,51778593,51760073,51756309,51786858,51766288,51751497,51780223,51775101,51800755,51790447,51765161,51753419,51789105,51778929,51789850,51794877,51759426,51754843,51785715,51785181,51794800,51780014,51763067,51753072,51781047,51785949,51763544,51764900,51764149,51761422,51780177,51759554,51755726,51783460,51798117,51793148,51758290,51757546,51763927,51768537,51785296,51801041,51765031,51757325,51787340,51761702,51769536,51771624,51776034,51797305,51768248,51761934,51799022,51793810,51801759,51740365,51756689,51784952,51762163,51800374,51764105,51789893,51780435,51797192,51775717,51798101,51762275,51781274,51775016,51784436,51799494,51796804,51774585,51762146,51773760,51777325,51799193,51773421,51755241,51800254,51771118,51765723,51754101,51789989,51802348,51769199,51797938,51801709,51770507,51782605,51788744,51763955,51800517,51785918,51797001,51790598,51777431,51773492,51779739,51764374,51756062,51775977,51785430,51761525,51771434,51772448,51764939,51774638,51783514,51781044,51784287,51797922,51772417,51777858,51786701,51764971,51754701,51757309,51783705,51782029,51767980,51798538,51801601,51782559,51799018,51761546,51786833,51781649,51762191,51752652,51764751,51798400,51784808,51802461,51762061,51776337,51785268,51778042,51776384,51761073,51758053,51752532,51754305,51792483,51762509,51800576,51762776,51793353,51779780,51759596,51776329,51758995,51763836,51769282,51778637,51793036,51800300,51763063,51772511,51788709,51789621,51788103,51780861,51797699,51781941,51774019,51776741,51763896,51794068,51769766,51780994,51781040,51769015,51795221,51769084,51801590,51775853,51786402,51781116,51757538,51780387,51792304,51775737,51758837,51790543,51802548,51781502,51769681,51759630,51801169,51756888,51776216,51789966,51797343,51761315,51757138,51784356,51790630,51778498,51760857,51802766,51772630,51761116,51766348,51752322,51788201,51773732,51759885,51769679,51784758,51768788,51790764,51704905,51771937,51764214,51752239,51778164,51774756,51762270,51751779,51762730,51802537,51776667,51793002,51771301,51771101,51777036,51781167,51802198,51764672,51773413,51784503,51797325,51786086,51760419,51768234,51760200,51753055,51802531,51753005,51771692,51778073,51799626,51801133,51790026,51717804,51712599,51710108,51714286,51737475,51701124,51744018,51748779,51728572,51725630,51723746,51738710,51748391,51748478,51721908,51735932,51743217,51711675,51730512,51726130,51733631,51729199,51711768,51733008,51715514,51743999,51716277,51742775,51746219,51719421,51741005,51717428,51720593,51722440,51721306,51729440,51713735,51742459,51714865,51718251,51718503,51748580,51717799,51719726,51713700,51743788,51715856,51721945,51723780,51725169,51719046,51728589,51748530,51732940,51726230,51718785,51720390,51715910,51728245,51729288,51717938,51713875,51719399,51724413,51713343,51737431,51721266,51741512,51742066,51733733,51725836,51742620,51717896,51738390,51736939,51733418,51722773,51748044,51742780,51749550,51722603,51718465,51749109,51721172,51722014,51729876,51726096,51715384,51750554,51734198,51720051,51712271,51730502,51729584,51733909,51712394,51717478,51725974,51721308,51740049,51749326,51709910,51734693,51728124,51712825,51727190,51734367,51738379,51750255,51712836,51733816,51735951,51713505,51727375,51714893,51718075,51728348,51738502,51746955,51712651,51745427,51709858,51718453,51730461,51720245,51748328,51727717,51738984,51725308,51719821,51720871,51716951,51728909,51710991,51720147,51733612,51719226,51711332,51742537,51729182,51737536,51714872,51737533,51726445,51741671,51717048,51736339,51740974,51733434,51717635,51708017,51720365,51744691,51748954,51727956,51743500,51747119,51725650,51740614,51730676,51740629,51713675,51739147,51714113,51728819,51725537,51747976,51744731,51734030,51739851,51730867,51712541,51728173,51729249,51725245,51728849,51739919,51711447,51746641,51718089,51741099,51738400,51730622,51745674,51722006,51719852,51732363,51717662,51749022,51713988,51740714,51732148,51736876,51720445,51740828,51729550,51719733,51715965,51718709,51743128,51730343,51709711,51743269,51744092,51714318,51739775,51725490,51715426,51731279,51731056,51735227,51716958,51710124,51735864,51748176,51735293,51738019,51744389,51738374,51716516,51718329,51748997,51717917,51726246,51723767,51714425,51712788,51723695,51713043,51746131,51740961,51719453,51738124,51730456,51718151,51719475,51739898,51738905,51725028,51709764,51712095,51739038,51713196,51731418,51738887,51712027,51735422,51732116,51719008,51723652,51745094,51732009,51712773,51735515,51717744,51722035,51735431,51740214,51711127,51718099,51743605,51715338,51719492,51718740,51738394,51711798,51712708,51711452,51730586,51739091,51729821,51722117,51737379,51725299,51733652,51719989,51704425,51711848,51710034,51739542,51724173,51715243,51728655,51730113,51747768,51726626,51719496,51728611,51713885,51732317,51724962,51721423,51720217,51723930,51713205,51723171,51721383,51734184,51720375,51735486,51710059,51725352,51750952,51712435,51715407,51722162,51724937,51736358,51726809,51715597,51710284,51710195,51727770,51735120,51726081,51734418,51732864,51741407,51717313,51743537,51745127,51730721,51729132,51715463,51744458,51735006,51748563,51736439,51747815,51710828,51730724,51743357,51729097,51714903,51710468,51719393,51728727,51748535,51730023,51724980,51711009,51733670,51724978,51721233,51718953,51722229,51712574,51738417,51727987,51737080,51724308,51750605,51737524,51736555,51716422,51730244,51719597,51724841,51735957,51711159,51745246,51726103,51724071,51714747,51731259,51744243,51724599,51736313,51716413,51721980,51726420,51739047,51713203,51747143,51705422,51712872,51732325,51720672,51738461,51745553,51710964,51719013,51725585,51725109,51744423,51739616,51715584,51724380,51732332,51741491,51713732,51719774,51718048,51749311,51732305,51719604,51736852,51735126,51746469,51724635,51724480,51722408,51741336,51744216,51717285,51718245,51745518,51749039,51729614,51733114,51745626,51719001,51716792,51722425,51746480,51744548,51725327,51719460,51714147,51716795,51733012,51711802,51719313,51746675,51732677";
        String[] userList = userNames.split(",");
        String[] loanIdList = loadIds.split(",");
        //平局单数向上取整
        int averageOrderCount = new BigDecimal(loanIdList.length).divide(new BigDecimal(userList.length), 0, BigDecimal.ROUND_CEILING).intValue();


        int i = 0;//外层循环次数（averageOrderCount）即派单多少轮
        int j = 0;//已分配的订单数（最大为orderCount）
        while (i < averageOrderCount) {
            for (int t = 0; t < userList.length; t++) {
                BackUser user = backUserDao.getUserByName(userList[t]);
                if (j < loanIdList.length) {
                    MmanLoanCollectionOrder order = mmanLoanCollectionOrderService.getOrderByLoanId(loanIdList[j]);
                    MmanUserLoan loan = mmanUserLoanService.get(loanIdList[j]);
                    CreditLoanPay pay = creditLoanPayService.get(order.getPayId());
                    updateOrder(user,order); //更新订单
                    updateLoan(loan);//更新借款表
                    updatePay(pay);//更新还款表
                    addChangeLog(user,order);//添加催收流转日志
                    j++;
                    System.out.println("订单：" + order.getLoanId() + " 处理完成！！当前第 " + j + " 条...当前催收员:"+user.getUserName());
                } else {//全部派单完成
                    System.out.println("订单处理完毕");
                }
            }
            i++;
            System.out.println("=================当前轮数："+ i);
        }

    }

    private void addChangeLog(BackUser user, MmanLoanCollectionOrder order) {
        mmanLoanCollectionStatusChangeLogService.deleteLogByOrderId(order.getOrderId());
        MmanLoanCollectionStatusChangeLog log = new MmanLoanCollectionStatusChangeLog();
        log.setLoanCollectionOrderId(order.getOrderId());
        log.setBeforeStatus("");
        log.setAfterStatus("0");
        log.setType("1"); // 1入催 2逾期等级转换 3转单 5催收成功
        log.setOperatorName("系统");
        log.setRemark("系统派单,当前催收员：" + user.getUserName());
        log.setCompanyId(user.getCompanyId());
        log.setCurrentCollectionUserId(user.getUuid());
        log.setCurrentCollectionUserLevel(user.getGroupLevel());
        log.setCurrentCollectionOrderLevel(user.getGroupLevel());

        mmanLoanCollectionStatusChangeLogService.insert(log);

    }

    private void updatePay(CreditLoanPay pay) {
        CreditLoanPay newPay = new CreditLoanPay();
        newPay.setId(pay.getId());
        newPay.setUpdateDate(new Date());
        creditLoanPayService.updateCreditLoanPay(newPay);
    }

    private void updateLoan(MmanUserLoan loan) {
        MmanUserLoan newLoan = new MmanUserLoan();
        newLoan.setId(loan.getId());
        newLoan.setCreateTime(new Date());
        newLoan.setUpdateTime(new Date());
        mmanUserLoanService.updateMmanUserLoan(newLoan);
    }

    private void updateOrder(BackUser user, MmanLoanCollectionOrder order) {
        MmanLoanCollectionOrder collectionOrder = new MmanLoanCollectionOrder();
        collectionOrder.setId(order.getId());
        collectionOrder.setCurrentOverdueLevel(user.getGroupLevel());
        collectionOrder.setLastCollectionUserId("");
//        collectionOrder.setLastCollectionUserId(order.getCurrentCollectionUserId());
        collectionOrder.setCurrentCollectionUserId(user.getUuid());
        collectionOrder.setOperatorName("系统");
        order.setRemark("系统派单");
        collectionOrder.setOutsideCompanyId(user.getCompanyId());
        collectionOrder.setDispatchTime(new Date());
        collectionOrder.setUpdateDate(new Date());
        collectionOrder.setCreateDate(new Date());

        mmanLoanCollectionOrderService.updateRecord(collectionOrder);
    }


}
